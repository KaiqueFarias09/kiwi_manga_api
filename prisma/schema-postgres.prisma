generator client {
    provider = "prisma-client-js"
    output   = "./prisma/postgres-client"
}

datasource db {
    provider = "postgresql"
    url      = env("POSTGRES_URL")
}

model User {
    id             String          @id @default(cuid())
    nickname       String
    email          String          @unique
    password       String
    profilePicture String          @default("")
    score          Int             @default(0)
    createdAt      DateTime        @default(now())
    favorites      Manga[]
    Collection     Collection[]
    FavoriteManga  FavoriteManga[]

    @@map("users")
}

model Manga {
    id              String            @id
    cover           String
    name            String
    synopsis        String
    User            User              @relation(fields: [userId], references: [id])
    userId          String
    Collection      Collection?       @relation(fields: [collectionId], references: [id])
    collectionId    String?
    MangaCollection MangaCollection[]
    FavoriteManga   FavoriteManga[]

    @@map("mangas")
}

model Collection {
    id          String @id @default(cuid())
    name        String
    description String

    user            User              @relation(fields: [userId], references: [id])
    userId          String
    mangas          Manga[]
    MangaCollection MangaCollection[]

    @@map("collections")
}

model MangaCollection {
    mangaId String
    manga   Manga  @relation(fields: [mangaId], references: [id])

    collectionId String
    collection   Collection @relation(fields: [collectionId], references: [id])

    @@id([mangaId, collectionId])
    @@map("manga_collection")
}

model FavoriteManga {
    mangaId String
    manga   Manga  @relation(fields: [mangaId], references: [id])

    userId String
    user   User   @relation(fields: [userId], references: [id])

    @@id([mangaId, userId])
    @@map("favorite_manga")
}
